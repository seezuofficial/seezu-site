<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SEEZU | Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#ffe6f0;
}

.container{
  max-width:420px;
  margin:40px auto;
  background:#fff;
  padding:25px;
  border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}

h1{
  text-align:center;
  color:#ff4f8b;
  margin-bottom:10px;
}

input{
  width:100%;
  padding:14px;
  margin:10px 0;
  border-radius:25px;
  border:2px solid #ff4f8b;
  outline:none;
  font-size:15px;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:25px;
  background:#ff4f8b;
  color:#fff;
  font-size:16px;
  cursor:pointer;
  margin-top:10px;
}

button:hover{
  opacity:0.9;
}

.switch{
  text-align:center;
  margin-top:15px;
  color:#555;
  cursor:pointer;
}

.hidden{
  display:none;
}

.user-box{
  text-align:center;
}

.logout{
  background:#444;
  margin-top:20px;
}
</style>
</head>

<body>

<div class="container">

  <!-- LOGIN -->
  <div id="loginBox">
    <h1>SEEZU Login</h1>
    <input id="loginEmail" type="email" placeholder="Email">
    <input id="loginPassword" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <div class="switch" onclick="showSignup()">Create new account</div>
  </div>

  <!-- SIGNUP -->
  <div id="signupBox" class="hidden">
    <h1>Create Account</h1>
    <input id="signupName" placeholder="Username">
    <input id="signupEmail" type="email" placeholder="Email">
    <input id="signupPassword" type="password" placeholder="Password">
    <button onclick="signup()">Sign Up</button>
    <div class="switch" onclick="showLogin()">Already have account?</div>
  </div>

  <!-- USER DASHBOARD -->
  <div id="userBox" class="hidden user-box">
    <h1 id="welcome"></h1>
    <p>You are logged in ðŸŽ‰</p>

    <button onclick="goChat()">Open Chat</button>
    <button class="logout" onclick="logout()">Logout</button>
  </div>

</div>

<!-- ðŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBkHcQJJ4HXU4R23J2nBy1z4ElL3_Hr1D0",
  authDomain: "seezu-1066d.firebaseapp.com",
  projectId: "seezu-1066d",
  storageBucket: "seezu-1066d.firebasestorage.app",
  messagingSenderId: "783067066542",
  appId: "1:783067066542:web:70c23adf7372b259a6fd3f"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// UI helpers
window.showSignup = () => {
  loginBox.classList.add("hidden");
  signupBox.classList.remove("hidden");
};

window.showLogin = () => {
  signupBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
};

// SIGNUP
window.signup = () => {
  const name = signupName.value;
  const email = signupEmail.value;
  const pass = signupPassword.value;

  if(!name || !email || !pass){
    alert("Fill all fields");
    return;
  }

  createUserWithEmailAndPassword(auth, email, pass)
  .then(res=>{
    set(ref(db,"users/"+res.user.uid),{
      name:name,
      email:email
    });
  })
  .catch(err=>alert(err.message));
};

// LOGIN
window.login = () => {
  signInWithEmailAndPassword(auth, loginEmail.value, loginPassword.value)
  .catch(err=>alert(err.message));
};

// LOGOUT
window.logout = () => signOut(auth);

// CHECK LOGIN
onAuthStateChanged(auth,user=>{
  if(user){
    get(ref(db,"users/"+user.uid)).then(snap=>{
      welcome.innerText = "Welcome " + snap.val().name;
    });

    loginBox.classList.add("hidden");
    signupBox.classList.add("hidden");
    userBox.classList.remove("hidden");
  }else{
    userBox.classList.add("hidden");
    loginBox.classList.remove("hidden");
  }
});

// CHAT PAGE
window.goChat = () => {
  window.location.href="chat.html";
};
</script>

</body>
</html>
